<html>
  <head>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap');
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background: #181A1B;
        color: #ECECEC;
        font-family: 'Inter', Roboto, sans-serif;
        min-height: 100vh;
      }
      .header {
        font-size: 2.5rem;
        font-weight: 700;
        text-align: center;
        margin-top: 2.5rem;
        margin-bottom: 2.5rem;
        color: #fff;
        text-shadow: 0 2px 24px #0a0a0a60;
      }
      .center-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
      }
      #g_id_onload, .g_id_signin {
        margin-top: 2.5rem;
      }
      .input-group {
        margin-top: 2rem;
        display: flex;
        gap: 1rem;
      }
      #userInput {
        background: #23272A;
        border: 1px solid #373B3E;
        color: #ECECEC;
        border-radius: 8px;
        padding: 0.75rem 1rem;
        font-size: 1rem;
        outline: none;
        transition: border 0.2s;
        margin-right: 1rem;
      }
      #userInput:focus {
        border: 1.5px solid #7289DA;
      }
      button.site-btn {
        background: #5865F2;
        color: #ECECEC;
        border: none;
        border-radius: 8px;
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
        font-family: 'Inter', Roboto, sans-serif;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 2px 16px #0002;
        transition: background 0.2s, color 0.2s;
      }
      button.site-btn:hover {
        background: #4752C4;
        color: #fff;
      }
      .error {
        color: #ff6961;
        margin-top: 1.2em;
        font-weight: bold;
        text-align: center;
      }
    </style>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
  </head>
  <body>
    <div class="center-content" id="mainPage">
      <div class="header">Project Ultra</div>
      <div id="gSignIn"></div>
      <div id="errorMsg" class="error" style="display:none;"></div>
    </div>
    <script>
      // --- CONFIGURATION ---
      const CLIENT_ID = "100317754160-4p89mb56cqqv8547slbmabpcfuq39lit.apps.googleusercontent.com";
      const allowedEmails = [
        "jensengeorge1290@gmail.com",
        ""
        // add more emails here
      ];

      // Helper to decode JWT (for Google Identity Services ID token)
      function parseJwt (token) {
        try {
          return JSON.parse(atob(token.split('.')[1]));
        } catch (e) {
          return {};
        }
      }

      function showError(msg) {
        const err = document.getElementById('errorMsg');
        if (!msg) {
          err.style.display = "none";
        } else {
          err.textContent = msg;
          err.style.display = "";
        }
      }

      // Insert the Google Sign-In button and initialize the flow
      window.onload = function() {
        window.handleCredentialResponse = function(response) {
          const payload = parseJwt(response.credential);
          if (!payload.email) {
            showError("Google sign-in failed.");
            return;
          }
          if (allowedEmails.includes(payload.email)) {
            openAboutBlankApp();
          } else {
            showError("This account is not authorized.");
          }
        };

        // Add the Google button
        const gDiv = document.getElementById('gSignIn');
        gDiv.innerHTML = `
          <div id="g_id_onload"
            data-client_id="${CLIENT_ID}"
            data-callback="handleCredentialResponse"
            data-auto_prompt="false"
            ></div>
          <div class="g_id_signin"
            data-type="standard"
            data-shape="rectangular"
            data-theme="filled_blue"
            data-text="sign_in_with"
            data-size="large"
            data-logo_alignment="left">
          </div>
        `;
      };

      function openAboutBlankApp() {
        const win = window.open('about:blank', '_blank');
        if (!win) {
          alert("Popup blocked! Please allow popups for this site.");
          return;
        }
        win.document.write(`
<!DOCTYPE html>
<html>
  <head>
    <title>Project Ultra</title>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background: #181A1B;
        color: #ECECEC;
        font-family: 'Inter', Roboto, sans-serif;
        min-height: 100vh;
      }
      .header {
        font-size: 2.5rem;
        font-weight: 700;
        text-align: center;
        margin-top: 2.5rem;
        margin-bottom: 2.5rem;
        color: #fff;
        text-shadow: 0 2px 24px #0a0a0a60;
      }
      .center-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
      }
      .input-group {
        margin-top: 2rem;
        display: flex;
        gap: 1rem;
      }
      #userInput {
        background: #23272A;
        border: 1px solid #373B3E;
        color: #ECECEC;
        border-radius: 8px;
        padding: 0.75rem 1rem;
        font-size: 1rem;
        outline: none;
        transition: border 0.2s;
        margin-right: 1rem;
      }
      #userInput:focus {
        border: 1.5px solid #7289DA;
      }
      button.site-btn {
        background: #5865F2;
        color: #ECECEC;
        border: none;
        border-radius: 8px;
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
        font-family: 'Inter', Roboto, sans-serif;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 2px 16px #0002;
        transition: background 0.2s, color 0.2s;
      }
      button.site-btn:hover {
        background: #4752C4;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="center-content">
      <div class="header">Project Ultra</div>
      <div class="input-group">
        <h2>by duckyman</h2>
        <br>
        <h2>some big sites might not work, like google and youtube. sorry, im working on it</h2>
        <br>
        <input type="text" id="userInput">
        <button class="site-btn" id="goBtn">click this</button>
      </div>
    </div>
    <script>
      var win;
      var lastUrl = "";
      var input = document.getElementById('userInput');
      var btn = document.getElementById('goBtn');
      input.oninput = function() {
        var currentUrl = this.value;
        if (currentUrl !== lastUrl) {
          btn.style.background = '';
          btn.innerHTML = "click this";
        }
      };
      btn.onclick = function() {
        var inputValue = input.value;
        var dynamicUrl = "https://" + inputValue;
        win = window.open();
        win.document.body.style.margin = '0';
        win.document.body.style.height = '100vh';
        var iframe = win.document.createElement('iframe');
        iframe.style.border = 'none';
        iframe.style.width = '100%';
        iframe.style.height = '100%';
        iframe.style.margin = '0';
        iframe.src = dynamicUrl;
        win.document.body.appendChild(iframe);
        lastUrl = inputValue;
        btn.style.background = 'grey';
        btn.innerHTML = "click this";
      };
    <\/script>
  </body>
</html>
        `);
        win.document.close();
      }
    </script>
  </body>
</html>
